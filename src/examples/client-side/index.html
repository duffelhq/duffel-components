<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="https://duffel.com/images/favicon/favicon-96x96.png"
    />
    <title>Checkout page example (Client side)</title>
    <!-- 1. This script loads duffel-components -->
    <script src="http://localhost:8000/components/DuffelCheckoutCustomElement.js"></script>
    <!-- uncomment below for the script in production -->
    <!-- <script src="https://assets.duffel.com/ancillaries-component/latest/DuffelCheckoutCustomElement.js"></script> -->
  </head>

  <body style="font-family: sans-serif">
    <h1>Checkout page (client side)</h1>

    <!-- 2. Add the custom element to your markup -->
    <duffel-checkout
      offer_id="fixture_off_0000AUde3KwTztSRK1cznH"
      client_key="__CLIENT_KEY__"
    ></duffel-checkout>
  </body>

  <script>
    window.onload = () => {
      // 3. Initialise component with data and customisation
      document
        .querySelector("duffel-checkout")
        .addEventListener(
          "connectedCallback",
          function ({ detail: initialiseWith }) {
            initialiseWith({
              passengers: [
                {
                  given_name: "Mae",
                  family_name: "Jemison",
                  gender: "F",
                  title: "dr",
                  born_on: "1956-10-17",
                  email: "m.jemison@nasa.gov",
                  phone_number: "+16177562626",
                },
                {
                  given_name: "Dorothy",
                  family_name: "Green",
                  gender: "F",
                  title: "dr",
                  born_on: "1942-10-17",
                },
              ],
            });
          }
        );

      // 4. Listen to 'onPayloadReady' event on the component
      document
        .querySelector("duffel-checkout")
        .addEventListener(
          "onPayloadReady",
          function ({ detail: { data: createOrderPayload, metadata } }) {
            // 5. Create an event handler to work with order creation payload
            console.log("Will create order with", createOrderPayload);
            console.log("Includes metadata", metadata);
          }
        );
    };
  </script>
</html>
